# Readme for the backend application

## Spring Initializr

This project was generated using Spring Initializr. The parameters used can be found in
`spring_initializr_params.png`.

`HELP.md` is a file generated by Spring Initializr. It contains references to documentation for
information on how to develop the application using Spring Boot and other components included in
the project.

## Launching the application

1. Open the project in IntelliJ IDEA (Community Edition).

On macOS, it can be installed as follows:

`brew install intellij-idea-ce`

2. Make sure the Docker containers are running:

`docker compose up -d`

Spring Boot has a feature to start up the containers automatically, but in order to build the
project, the PostgreSQL database needs to be running already in the build phase to enable running
Flyway migrations and then generating Kotlin code from the final database schema by jOOQ.

3. Build the project.

4. Run the main application.

The REST API endpoints are available in http://localhost:8080/api/v1/.
See `src/main/kotlin/com/studentmeals/server/rest/` for more information.

## Flyway

Flyway is used to define the database schema by having incremental database migration scripts.
The scripts are written in (Postgre)SQL and can be found in `src/main/resources/db/migration`.
Do not modify already published migration scripts but create new ones with newer version numbers,
e.g. `V2_0__new_entity.sql`.

## jOOQ

jOOQ is used as a SQL builder with code generation and a SQL executor.
See https://www.jooq.org/doc/3.18.6/manual-single-page/ for more information.

## PostgreSQL

PostgreSQL is run in its own container defined in the Docker Compose file `compose.yaml`.
Parameters for the database and the connection can be found in `.env` file located in the root of
the project.

## .env file

The variables defined in this file are used both in the Docker compose file, `compose.yaml`,
and the Gradle build file, `build.gradle.kts`. The former works automatically and the latter works
with the help of a library, `co.uzzu.dotenv.gradle`.

NOTE: The `.env` file should not actually be stored in version control, but I reckon that this is
okay for now for simplicity. Passwords should not be stored in version control, but this is only
a development-time setup for local development environments. DO NOT USE IN PRODUCTION!!
